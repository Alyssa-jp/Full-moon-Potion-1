<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Potion — size fit</title>
<style>
:root{
:root{
  --stage: min(92vw, 520px);

  /* 蓋（右に寄り過ぎ→左へ寄せる） */
  --cap-top: 7%;
  --cap-left: 31%;
  --cap-width: 27%;

  /* 液体の枠（少し上げて幅を広げる） */
  --liq-left: 18%;
  --liq-top: 46%;
  --liq-width: 64%;
  --liq-height: 32%;
}

/* ……下は重なり順の修正だけ追加 …… */

.stage img.base{
  position:absolute;inset:0;width:100%;height:auto;
  user-select:none;pointer-events:none;
  filter:drop-shadow(0 14px 32px rgba(0,0,0,.45));
  z-index:2;              /* 瓶は2 */
}

.liq-box{
  position:absolute;left:var(--liq-left);top:var(--liq-top);
  width:var(--liq-width);height:var(--liq-height);
  overflow:hidden;border-radius:26%/22%;
  z-index:3;              /* 液体は3（＝瓶より上） */
}
#Liquid{
  position:absolute;inset:-6% -6% -6% -6%;
  width:112%;height:auto;object-fit:cover;
  transform-origin:50% 60%;transition:transform .2s ease-out;
}

#Cap{                     /* 蓋はいちばん上 */
  position:absolute;width:var(--cap-width);
  left:var(--cap-left);top:var(--cap-top);
  will-change:transform,opacity;
  filter:drop-shadow(0 6px 20px rgba(0,0,0,.45));
  z-index:4;
}
</style>
</head>
<body>

  <div class="stage" id="stage">
    <!-- 瓶の中の液体（まず枠に収める） -->
    <div class="liq-box">
      <img id="Liquid" src="Liquid.PNG" alt="liquid">
    </div>

    <!-- 瓶本体 -->
    <img class="base" id="Bottle" src="Bottle.PNG" alt="bottle">

    <!-- 蓋 -->
    <img id="Cap" src="Cap.PNG" alt="cap">
  </div>

  <div class="controls">
    <button id="capBtn">Open cap</button>
    <button id="tiltBtn">Tilt</button>
  </div>

<script>
  // まずはサイズ合わせ確認用の最小スクリプト（動きはおまけ）
  const body = document.body;
  const capBtn = document.getElementById('capBtn');
  const tiltBtn = document.getElementById('tiltBtn');
  const liquid  = document.getElementById('Liquid');

  capBtn.onclick = ()=>{
    body.classList.toggle('open');
    capBtn.textContent = body.classList.contains('open') ? 'Close cap' : 'Open cap';
  };

  let tilted=false;
  tiltBtn.onclick = ()=>{
    tilted=!tilted;
    const scale = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--liq-rotate-scale')) || .7;
    liquid.style.transform = tilted ? `rotate(-22deg) scaleY(${scale})` : 'none';
    tiltBtn.textContent = tilted ? 'Reset' : 'Tilt';
  };
</script>
</body>
</html>
